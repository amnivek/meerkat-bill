"use strict";(self["webpackChunkmeerkat_bill"]=self["webpackChunkmeerkat_bill"]||[]).push([[29],{5029:(e,t,l)=>{l.r(t),l.d(t,{default:()=>de});var a=l(3673);const n={class:"row justify-between"},o={class:"row justify-between"},s=(0,a._)("div",{class:"q-mt-lg text-grey"},[(0,a._)("p",null,[(0,a._)("b",null,"蒙哥账单"),(0,a.Uk)(" 是一款多人账单计算器。如多人在一次活动中都有付款，每次付款又可能涉及不同的参与者，可快速计算每个人的支付金额。 ")]),(0,a._)("p",null,"由 Kevin Ma 设计开发。")],-1);function r(e,t,l,r,i,u){const m=(0,a.up)("members"),d=(0,a.up)("q-space"),p=(0,a.up)("q-btn"),c=(0,a.up)("q-stepper-navigation"),b=(0,a.up)("q-step"),w=(0,a.up)("bills"),f=(0,a.up)("check"),g=(0,a.up)("q-stepper"),_=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(_,{padding:""},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{modelValue:e.step,"onUpdate:modelValue":t[0]||(t[0]=t=>e.step=t),animated:"",color:"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{name:1,title:"成员",icon:"group","active-icon":"group","done-icon":"group",done:e.step>1},{default:(0,a.w5)((()=>[(0,a.Wm)(m),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a._)("div",n,[(0,a.Wm)(d),(0,a.Wm)(p,{push:"",color:"primary",label:"账单","icon-right":"navigate_next",onClick:e.next},null,8,["onClick"])])])),_:1})])),_:1},8,["done"]),(0,a.Wm)(b,{name:2,title:"账单",icon:"receipt","active-icon":"receipt","done-icon":"receipt",done:e.step>2},{default:(0,a.w5)((()=>[(0,a.Wm)(w),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a.Wm)(p,{push:"",color:"primary",label:"成员",icon:"navigate_before",onClick:e.back},null,8,["onClick"]),(0,a.Wm)(p,{push:"",color:"primary",label:"结算","icon-right":"navigate_next",onClick:e.next},null,8,["onClick"])])])),_:1})])),_:1},8,["done"]),(0,a.Wm)(b,{name:3,title:"结算",icon:"receipt_long","active-icon":"receipt_long","done-icon":"receipt_long",done:e.step>3},{default:(0,a.w5)((()=>[(0,a.Wm)(f),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{push:"",color:"primary",label:"账单",icon:"navigate_before",onClick:e.back},null,8,["onClick"])])),_:1})])),_:1},8,["done"])])),_:1},8,["modelValue"]),s])),_:1})}var i=l(1959),u=l(7874),m=l(2323);const d={class:"row q-gutter-sm"},p={class:"col-auto"},c=(0,a.Uk)("添加");function b(e,t,l,n,o,s){const r=(0,a.up)("q-chip"),i=(0,a.up)("q-btn"),u=(0,a.up)("add-member"),b=(0,a.up)("q-dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.$store.state.meerkat.members,(t=>((0,a.wg)(),(0,a.iD)("div",{key:t,class:"col-auto"},[0===e.$store.state.meerkat.count[t]?((0,a.wg)(),(0,a.j4)(r,{key:0,ripple:!1,removable:"",onRemove:l=>e.$store.commit("meerkat/removeMember",t)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,m.zw)(t),1)])),_:2},1032,["onRemove"])):((0,a.wg)(),(0,a.j4)(r,{key:1,ripple:!1},{default:(0,a.w5)((()=>[(0,a.Uk)((0,m.zw)(t),1)])),_:2},1024))])))),128)),(0,a._)("div",p,[(0,a.Wm)(i,{push:"",rounded:"",color:"primary","text-color":"white",icon:"add",onClick:t[0]||(t[0]=t=>e.dialog=!0)},{default:(0,a.w5)((()=>[c])),_:1})])]),(0,a.Wm)(b,{modelValue:e.dialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.dialog=t)},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{onSuccess:t[1]||(t[1]=t=>e.dialog=!1)})])),_:1},8,["modelValue"])],64)}const w=(0,a._)("div",{class:"text-h6"},"添加新成员",-1);function f(e,t,l,n,o,s){const r=(0,a.up)("q-card-section"),i=(0,a.up)("q-icon"),u=(0,a.up)("q-input"),m=(0,a.up)("q-btn"),d=(0,a.up)("q-card-actions"),p=(0,a.up)("q-card"),c=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(p,{style:{"min-width":"350px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[w])),_:1}),(0,a.Wm)(r,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{ref:"nameInput",modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.name=t),outlined:"",label:"名称",rules:[e=>!!e||"请输入名称",t=>e.$store.state.meerkat.members.indexOf(t)<0||"名称已存在"]},{prepend:(0,a.w5)((()=>[(0,a.Wm)(i,{name:"person"})])),_:1},8,["modelValue","rules"])])),_:1}),(0,a.Wm)(d,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(m,{flat:"",label:"取消"},null,512),[[c]]),(0,a.Wm)(m,{push:"",color:"primary",label:"添加",onClick:e.add},null,8,["onClick"])])),_:1})])),_:1})}const g=(0,a.aZ)({name:"AddMember",emits:["success"],data(){return{name:""}},methods:{add(){this.$refs.nameInput.validate()&&(this.$store.commit("meerkat/addMember",this.name),this.$emit("success"))}}});var _=l(151),h=l(5589),k=l(4842),W=l(4554),v=l(9367),q=l(8240),Z=l(677),y=l(7518),Q=l.n(y);g.render=f;const C=g;Q()(g,"components",{QCard:_.Z,QCardSection:h.Z,QInput:k.Z,QIcon:W.Z,QCardActions:v.Z,QBtn:q.Z}),Q()(g,"directives",{ClosePopup:Z.Z});const V=(0,a.aZ)({name:"Members",components:{AddMember:C},data(){return{dialog:!1}}});var x=l(7030),$=l(5926);V.render=b;const D=V;Q()(V,"components",{QChip:x.Z,QBtn:q.Z,QDialog:$.Z}),(0,a.dD)("data-v-0aa51e25");const I=(0,a._)("b",null,"付款人",-1),U={class:"q-ml-sm"},B=(0,a._)("b",null,"参与者",-1),M={key:0};function S(e,t,l,n,o,s){const r=(0,a.up)("q-item-label"),i=(0,a.up)("q-item-section"),u=(0,a.up)("q-btn"),d=(0,a.up)("q-item"),p=(0,a.up)("q-separator"),c=(0,a.up)("q-list"),b=(0,a.up)("add-bill"),w=(0,a.up)("q-dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.$store.state.meerkat.bills,((t,l)=>((0,a.wg)(),(0,a.iD)(a.HY,{key:l},[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[I,(0,a._)("span",U,(0,m.zw)(t.payer),1)])),_:2},1024),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[B,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.participants,((e,l)=>((0,a.wg)(),(0,a.iD)("span",{key:e,class:"q-ml-sm"},[(0,a._)("span",null,(0,m.zw)(e),1),l+1<t.participants.length?((0,a.wg)(),(0,a.iD)("span",M,",")):(0,a.kq)("",!0)])))),128))])),_:2},1024)])),_:2},1024),(0,a.Wm)(i,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,m.zw)(t.memo),1)])),_:2},1024),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Uk)("¥"+(0,m.zw)(t.amount),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(i,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{flat:"",dense:"",color:"dark",icon:"delete",onClick:t=>e.$store.commit("meerkat/deleteBill",l)},null,8,["onClick"])])),_:2},1024)])),_:2},1024),(0,a.Wm)(p,{spaced:""})],64)))),128))])),_:1}),(0,a.Wm)(u,{push:"",rounded:"",color:"primary",class:"q-mt-md full-width",label:"添加消费",icon:"add",onClick:t[0]||(t[0]=t=>e.dialog=!0)}),(0,a.Wm)(w,{modelValue:e.dialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.dialog=t),persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{onSuccess:t[1]||(t[1]=t=>e.dialog=!1)})])),_:1},8,["modelValue"])],64)}(0,a.Cn)();const z=(0,a._)("div",{class:"text-h6"},"添加账单",-1);function A(e,t,l,n,o,s){const r=(0,a.up)("q-card-section"),i=(0,a.up)("q-icon"),u=(0,a.up)("q-select"),m=(0,a.up)("q-btn"),d=(0,a.up)("q-input"),p=(0,a.up)("q-card-actions"),c=(0,a.up)("q-card"),b=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(c,{style:{"min-width":"360px","max-width":"520px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[z])),_:1}),(0,a.Wm)(r,{class:"q-pt-none q-gutter-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{ref:"payer",modelValue:e.bill.payer,"onUpdate:modelValue":t[0]||(t[0]=t=>e.bill.payer=t),outlined:"",options:e.$store.state.meerkat.members,label:"付款人",rules:[e=>!!e||"请选择付款人"]},{prepend:(0,a.w5)((()=>[(0,a.Wm)(i,{name:"person"})])),_:1},8,["modelValue","options","rules"]),(0,a.Wm)(u,{ref:"participants",modelValue:e.bill.participants,"onUpdate:modelValue":t[1]||(t[1]=t=>e.bill.participants=t),outlined:"",multiple:"","use-chips":"",options:e.$store.state.meerkat.members,label:"参与者",hint:"付款人如需均摊也应包含在内",rules:[e=>e.length>0||"请选择至少一位参与者"]},{prepend:(0,a.w5)((()=>[(0,a.Wm)(i,{name:"people"})])),"before-options":(0,a.w5)((()=>[(0,a.Wm)(m,{class:"full-width q-py-md",align:"left",flat:"",label:"选择全部",onClick:e.selectAllMemberAsParticipants},null,8,["onClick"])])),_:1},8,["modelValue","options","rules"]),(0,a.Wm)(d,{ref:"amount",modelValue:e.bill.amount,"onUpdate:modelValue":t[2]||(t[2]=t=>e.bill.amount=t),modelModifiers:{number:!0},outlined:"",label:"金额",type:"number",rules:[e=>!!e||"请输入正确金额"]},{prepend:(0,a.w5)((()=>[(0,a.Wm)(i,{name:"paid"})])),_:1},8,["modelValue","rules"]),(0,a.Wm)(d,{modelValue:e.bill.memo,"onUpdate:modelValue":t[3]||(t[3]=t=>e.bill.memo=t),outlined:"",label:"备忘（可选）",type:"text"},{prepend:(0,a.w5)((()=>[(0,a.Wm)(i,{name:"comment"})])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(p,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(m,{flat:"",label:"取消"},null,512),[[b]]),(0,a.Wm)(m,{push:"",color:"primary",label:"添加",onClick:e.add},null,8,["onClick"])])),_:1})])),_:1})}const H=(0,a.aZ)({name:"AddBill",emits:["success"],data(){return{bill:{payer:"",participants:[],amount:"",memo:""}}},methods:{selectAllMemberAsParticipants(){this.bill.participants=this.$store.state.meerkat.members},add(){this.$refs.payer.validate()&&this.$refs.participants.validate()&&this.$refs.amount.validate()&&(this.$store.commit("meerkat/addBill",this.bill),this.$emit("success"))}}});var Y=l(9056);H.render=A;const j=H;Q()(H,"components",{QCard:_.Z,QCardSection:h.Z,QSelect:Y.Z,QIcon:W.Z,QBtn:q.Z,QInput:k.Z,QCardActions:v.Z}),Q()(H,"directives",{ClosePopup:Z.Z});const P=(0,a.aZ)({name:"Bills",components:{AddBill:j},data(){return{dialog:!1}}});var K=l(7011),L=l(3414),O=l(2035),R=l(2350),N=l(5869);P.render=S,P.__scopeId="data-v-0aa51e25";const T=P;Q()(P,"components",{QList:K.Z,QItem:L.Z,QItemSection:O.Z,QItemLabel:R.Z,QBtn:q.Z,QSeparator:N.Z,QDialog:$.Z});const E=(0,a._)("span",{class:"q-mx-sm"},"人共计消费",-1),F=(0,a._)("span",{class:"q-mx-sm"},"需向",-1),G=(0,a._)("span",{class:"q-mx-sm"},"支付",-1);function J(e,t,l,n,o,s){const r=(0,a.up)("q-banner"),i=(0,a.up)("q-item-label"),u=(0,a.up)("q-item-section"),d=(0,a.up)("q-item"),p=(0,a.up)("q-list");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(r,{class:"q-mb-lg bg-grey-3",rounded:""},{default:(0,a.w5)((()=>[(0,a._)("b",null,(0,m.zw)(e.$store.getters["meerkat/totalMembers"]),1),E,(0,a._)("b",null,"¥"+(0,m.zw)(e.$store.getters["meerkat/totalBills"]),1)])),_:1}),(0,a.Wm)(p,{separator:"",bordered:"",class:"rounded-borders"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.data,((e,t)=>((0,a.wg)(),(0,a.j4)(d,{key:t},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(i,null,{default:(0,a.w5)((()=>[(0,a._)("b",null,(0,m.zw)(e.from),1),F,(0,a._)("b",null,(0,m.zw)(e.to),1),G,(0,a._)("b",null,"¥"+(0,m.zw)(e.amount),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})],64)}var X=l(4228);function ee(e){return Math.trunc(100*e)}function te(e,t){const l=[];for(var a=0;a<e.length;a++){const t=[];for(var n=0;n<e.length;n++)t.push((0,X.Z)({amount:0}));l.push(t)}for(var o=0;o<t.length;o++){const a=t[o],n=a.payer,s=a.participants,r=(0,X.Z)({amount:ee(a.amount)}),i=r.divide(s.length),u=e.indexOf(n);s.forEach((t=>{const a=e.indexOf(t);a!=u&&(l[a][u]=l[a][u].add(i))}))}for(var s=1;s<l.length;s++)for(var r=0;r<s;r++)if(s!=r){var i=s,u=r;l[s][r].lessThan(l[r][s])&&(i=r,u=s),l[i][u]=l[i][u].subtract(l[u][i]),l[u][i]=(0,X.Z)({amount:0})}const m=[];for(var d=0;d<l.length;d++)for(var p=0;p<l.length;p++)l[d][p].greaterThan((0,X.Z)({amount:0}))&&m.push({from:e[d],to:e[p],amount:l[d][p].toFormat("0,0.00")});return m}X.Z.defaultCurrency="CNY",X.Z.defaultPrecision=2;const le=(0,a.aZ)({name:"Check",data(){return{data:[]}},mounted(){this.data=te(this.$store.state.meerkat.members,this.$store.state.meerkat.bills)}});var ae=l(5607);le.render=J;const ne=le;Q()(le,"components",{QBanner:ae.Z,QList:K.Z,QItem:L.Z,QItemSection:O.Z,QItemLabel:R.Z});const oe=(0,a.aZ)({name:"PageIndex",components:{Members:D,Bills:T,Check:ne},setup(){const e=(0,u.oR)(),t=(0,i.iH)(e.getters["meerkat/step"]);return{step:t,next(){t.value++},back(){t.value--}}}});var se=l(4379),re=l(3518),ie=l(4340),ue=l(118),me=l(2025);oe.render=r;const de=oe;Q()(oe,"components",{QPage:se.Z,QStepper:re.Z,QStep:ie.Z,QStepperNavigation:ue.Z,QSpace:me.Z,QBtn:q.Z})}}]);