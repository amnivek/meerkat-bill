"use strict";(self["webpackChunkmeerkat_bill"]=self["webpackChunkmeerkat_bill"]||[]).push([[273],{8273:(e,l,t)=>{t.r(l),t.d(l,{default:()=>ne});var a=t(3673);const n={class:"row justify-between"},o={class:"row justify-between"},i=(0,a._)("div",{class:"q-mt-lg text-grey"},[(0,a._)("p",null,[(0,a._)("b",null,"蒙哥账单"),(0,a.Uk)(" 是一款多人账单计算器。如多人在一次活动中都有付款，每次付款又可能涉及不同的参与者，可快速计算每个人的支付金额。 ")]),(0,a._)("p",null,"由 Kevin Ma 设计开发。")],-1);function r(e,l,t,r,s,u){const m=(0,a.up)("members"),d=(0,a.up)("q-space"),c=(0,a.up)("q-btn"),p=(0,a.up)("q-stepper-navigation"),w=(0,a.up)("q-step"),f=(0,a.up)("bills"),g=(0,a.up)("check"),_=(0,a.up)("q-stepper"),b=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(b,{padding:""},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{modelValue:e.step,"onUpdate:modelValue":l[0]||(l[0]=l=>e.step=l),animated:"",color:"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{name:1,title:"成员",icon:"group","active-icon":"group","done-icon":"group",done:e.step>1},{default:(0,a.w5)((()=>[(0,a.Wm)(m),(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("div",n,[(0,a.Wm)(d),(0,a.Wm)(c,{color:"primary",label:"账单","icon-right":"navigate_next",onClick:e.next},null,8,["onClick"])])])),_:1})])),_:1},8,["done"]),(0,a.Wm)(w,{name:2,title:"账单",icon:"receipt","active-icon":"receipt","done-icon":"receipt",done:e.step>2},{default:(0,a.w5)((()=>[(0,a.Wm)(f),(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a.Wm)(c,{color:"primary",label:"成员",icon:"navigate_before",onClick:e.back},null,8,["onClick"]),(0,a.Wm)(c,{color:"primary",label:"结算","icon-right":"navigate_next",onClick:e.next},null,8,["onClick"])])])),_:1})])),_:1},8,["done"]),(0,a.Wm)(w,{name:3,title:"结算",icon:"receipt_long","active-icon":"receipt_long","done-icon":"receipt_long",done:e.step>3},{default:(0,a.w5)((()=>[(0,a.Wm)(g),(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{color:"primary",label:"账单",icon:"navigate_before",onClick:e.back},null,8,["onClick"])])),_:1})])),_:1},8,["done"])])),_:1},8,["modelValue"]),i])),_:1})}var s=t(1959),u=t(7874),m=t(2323);const d={class:"row q-gutter-sm"},c={class:"col-auto"},p=(0,a.Uk)("添加"),w=(0,a._)("div",{class:"text-h6"},"添加新成员",-1);function f(e,l,t,n,o,i){const r=(0,a.up)("q-chip"),s=(0,a.up)("q-card-section"),u=(0,a.up)("q-icon"),f=(0,a.up)("q-input"),g=(0,a.up)("q-btn"),_=(0,a.up)("q-card-actions"),b=(0,a.up)("q-card"),h=(0,a.up)("q-dialog"),W=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.$store.state.meerkat.members,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e,class:"col-auto"},[(0,a.Wm)(r,{outline:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,m.zw)(e),1)])),_:2},1024)])))),128)),(0,a._)("div",c,[(0,a.Wm)(r,{clickable:"",color:"dark","text-color":"white",icon:"add",onClick:e.showDialog},{default:(0,a.w5)((()=>[p])),_:1},8,["onClick"])])]),(0,a.Wm)(h,{modelValue:e.dialog,"onUpdate:modelValue":l[1]||(l[1]=l=>e.dialog=l)},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{style:{"min-width":"350px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[w])),_:1}),(0,a.Wm)(s,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{ref:"name",modelValue:e.newMember,"onUpdate:modelValue":l[0]||(l[0]=l=>e.newMember=l),outlined:"",label:"名称",rules:[e=>!!e||"请输入名称"]},{prepend:(0,a.w5)((()=>[(0,a.Wm)(u,{name:"person"})])),_:1},8,["modelValue","rules"])])),_:1}),(0,a.Wm)(_,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(g,{flat:"",label:"取消"},null,512),[[W]]),(0,a.Wm)(g,{flat:"",label:"添加",onClick:e.addMember},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}const g=(0,a.aZ)({name:"Members",data(){return{newMember:"",dialog:!1}},watch:{dialog(e){e||(this.newMember="")}},methods:{showDialog(){this.dialog=!0},addMember(){this.$refs.name.validate()&&(this.$store.commit("meerkat/addMember",this.newMember),this.dialog=!1)}}});var _=t(7030),b=t(5926),h=t(151),W=t(5589),k=t(4842),v=t(4554),q=t(9367),Z=t(8240),C=t(677),Q=t(7518),y=t.n(Q);g.render=f;const x=g;y()(g,"components",{QChip:_.Z,QDialog:b.Z,QCard:h.Z,QCardSection:W.Z,QInput:k.Z,QIcon:v.Z,QCardActions:q.Z,QBtn:Z.Z}),y()(g,"directives",{ClosePopup:C.Z}),(0,a.dD)("data-v-7048ee12");const V=(0,a._)("b",null,"付款人",-1),B={class:"q-ml-sm"},D=(0,a._)("b",null,"参与者",-1),M=(0,a._)("div",{class:"text-h6"},"添加账单",-1);function $(e,l,t,n,o,i){const r=(0,a.up)("q-item-label"),s=(0,a.up)("q-item-section"),u=(0,a.up)("q-btn"),d=(0,a.up)("q-item"),c=(0,a.up)("q-separator"),p=(0,a.up)("q-list"),w=(0,a.up)("q-card-section"),f=(0,a.up)("q-icon"),g=(0,a.up)("q-select"),_=(0,a.up)("q-input"),b=(0,a.up)("q-card-actions"),h=(0,a.up)("q-card"),W=(0,a.up)("q-dialog"),k=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.$store.state.meerkat.bills,((l,t)=>((0,a.wg)(),(0,a.iD)(a.HY,{key:t},[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[V,(0,a._)("span",B,(0,m.zw)(l.payer),1)])),_:2},1024),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[D,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.participants,(e=>((0,a.wg)(),(0,a.iD)("span",{key:e,class:"q-ml-sm"},(0,m.zw)(e),1)))),128))])),_:2},1024)])),_:2},1024),(0,a.Wm)(s,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,m.zw)(l.memo),1)])),_:2},1024),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Uk)("¥"+(0,m.zw)(l.amount),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(s,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{flat:"",round:"",dense:"",color:"black",icon:"delete",onClick:l=>e.$store.commit("meerkat/deleteBill",t)},null,8,["onClick"])])),_:2},1024)])),_:2},1024),(0,a.Wm)(c,{spaced:""})],64)))),128))])),_:1}),(0,a.Wm)(u,{color:"dark",class:"full-width",label:"添加消费",icon:"add",onClick:e.showDialog},null,8,["onClick"]),(0,a.Wm)(W,{modelValue:e.dialog,"onUpdate:modelValue":l[4]||(l[4]=l=>e.dialog=l)},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{style:{"min-width":"360px","max-width":"520px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[M])),_:1}),(0,a.Wm)(w,{class:"q-pt-none q-gutter-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{ref:"payer",modelValue:e.newBill.payer,"onUpdate:modelValue":l[0]||(l[0]=l=>e.newBill.payer=l),outlined:"",options:e.$store.state.meerkat.members,label:"付款人",rules:[e=>!!e||"请选择付款人"]},{prepend:(0,a.w5)((()=>[(0,a.Wm)(f,{name:"person"})])),_:1},8,["modelValue","options","rules"]),(0,a.Wm)(g,{ref:"participants",modelValue:e.newBill.participants,"onUpdate:modelValue":l[1]||(l[1]=l=>e.newBill.participants=l),outlined:"",multiple:"",options:e.$store.state.meerkat.members,label:"参与者",hint:"付款人如需均摊也应包含在内",rules:[e=>e.length>0||"请选择至少一位参与者"]},{prepend:(0,a.w5)((()=>[(0,a.Wm)(f,{name:"people"})])),"before-options":(0,a.w5)((()=>[(0,a.Wm)(u,{class:"full-width q-py-md",align:"left",flat:"",label:"选择全部",onClick:e.selectAllMemberAsParticipants},null,8,["onClick"])])),_:1},8,["modelValue","options","rules"]),(0,a.Wm)(_,{ref:"amount",modelValue:e.newBill.amount,"onUpdate:modelValue":l[2]||(l[2]=l=>e.newBill.amount=l),modelModifiers:{number:!0},outlined:"",label:"金额",type:"number",rules:[e=>!!e||"请输入金额"]},{prepend:(0,a.w5)((()=>[(0,a.Wm)(f,{name:"paid"})])),_:1},8,["modelValue","rules"]),(0,a.Wm)(_,{modelValue:e.newBill.memo,"onUpdate:modelValue":l[3]||(l[3]=l=>e.newBill.memo=l),outlined:"",label:"备忘（可选）",type:"text"},{prepend:(0,a.w5)((()=>[(0,a.Wm)(f,{name:"comment"})])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(b,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{flat:"",label:"取消"},null,512),[[k]]),(0,a.Wm)(u,{flat:"",label:"添加",onClick:e.addBill},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}(0,a.Cn)();const I=(0,a.aZ)({name:"Bills",data(){return{dialog:!1,newBill:{payer:null,participants:[],amount:null,memo:null}}},watch:{dialog(e){e||(this.newBill={payer:null,participants:[],amount:null,memo:null})}},methods:{showDialog(){this.dialog=!0},selectAllMemberAsParticipants(){this.newBill.participants=this.$store.state.meerkat.members},addBill(){this.$refs.payer.validate()&&this.$refs.participants.validate()&&this.$refs.amount.validate()&&(this.$store.commit("meerkat/addBill",this.newBill),this.dialog=!1)}}});var U=t(7011),S=t(3414),z=t(2035),H=t(2350),Y=t(5869),P=t(9056);I.render=$,I.__scopeId="data-v-7048ee12";const A=I;y()(I,"components",{QList:U.Z,QItem:S.Z,QItemSection:z.Z,QItemLabel:H.Z,QBtn:Z.Z,QSeparator:Y.Z,QDialog:b.Z,QCard:h.Z,QCardSection:W.Z,QSelect:P.Z,QIcon:v.Z,QInput:k.Z,QCardActions:q.Z}),y()(I,"directives",{ClosePopup:C.Z}),(0,a.dD)("data-v-451672c6");const K=(0,a._)("span",{class:"q-mx-sm"},"人共计消费",-1),L=(0,a._)("span",{class:"q-mx-xs"},"需向",-1),j=(0,a._)("span",{class:"q-mx-xs"},"支付",-1);function N(e,l,t,n,o,i){const r=(0,a.up)("q-banner"),s=(0,a.up)("q-item-label"),u=(0,a.up)("q-item-section"),d=(0,a.up)("q-item"),c=(0,a.up)("q-separator"),p=(0,a.up)("q-list");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(r,{class:"q-mb-lg bg-grey-3",rounded:""},{default:(0,a.w5)((()=>[(0,a._)("b",null,(0,m.zw)(e.$store.getters["meerkat/totalMembers"]),1),K,(0,a._)("b",null,"¥"+(0,m.zw)(e.$store.getters["meerkat/totalBills"]),1)])),_:1}),(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.data,((e,l)=>((0,a.wg)(),(0,a.iD)(a.HY,{key:l},[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[(0,a._)("b",null,(0,m.zw)(e.from),1),L,(0,a._)("b",null,(0,m.zw)(e.to),1),j,(0,a._)("b",null,"¥"+(0,m.zw)(e.amount),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),(0,a.Wm)(c,{spaced:""})],64)))),128))])),_:1})],64)}(0,a.Cn)();var O=t(4228);function T(e){return Math.trunc(100*e)}function E(e,l){const t=[];for(var a=0;a<e.length;a++){const l=[];for(var n=0;n<e.length;n++)l.push((0,O.Z)({amount:0}));t.push(l)}for(var o=0;o<l.length;o++){const a=l[o],n=a.payer,i=a.participants,r=(0,O.Z)({amount:T(a.amount)}),s=r.divide(i.length),u=e.indexOf(n);i.forEach((l=>{const a=e.indexOf(l);a!=u&&(t[a][u]=t[a][u].add(s))}))}for(var i=1;i<t.length;i++)for(var r=0;r<i;r++)if(i!=r){var s=i,u=r;t[i][r].lessThan(t[r][i])&&(s=r,u=i),t[s][u]=t[s][u].subtract(t[u][s]),t[u][s]=(0,O.Z)({amount:0})}const m=[];for(var d=0;d<t.length;d++)for(var c=0;c<t.length;c++)t[d][c].greaterThan((0,O.Z)({amount:0}))&&m.push({from:e[d],to:e[c],amount:t[d][c].toFormat("0,0.00")});return m}O.Z.defaultCurrency="CNY",O.Z.defaultPrecision=2;const F=(0,a.aZ)({name:"Check",data(){return{data:[]}},mounted(){this.data=E(this.$store.state.meerkat.members,this.$store.state.meerkat.bills)}});var R=t(5607);F.render=N,F.__scopeId="data-v-451672c6";const G=F;y()(F,"components",{QBanner:R.Z,QList:U.Z,QItem:S.Z,QItemSection:z.Z,QItemLabel:H.Z,QSeparator:Y.Z});const J=(0,a.aZ)({name:"PageIndex",components:{Members:x,Bills:A,Check:G},setup(){const e=(0,u.oR)(),l=(0,s.iH)(e.getters["meerkat/step"]);return{step:l,next(){l.value++},back(){l.value--}}}});var X=t(4379),ee=t(3518),le=t(4340),te=t(118),ae=t(2025);J.render=r;const ne=J;y()(J,"components",{QPage:X.Z,QStepper:ee.Z,QStep:le.Z,QStepperNavigation:te.Z,QSpace:ae.Z,QBtn:Z.Z})}}]);