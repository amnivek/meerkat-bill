"use strict";(self["webpackChunkmeerkat_bill"]=self["webpackChunkmeerkat_bill"]||[]).push([[310],{4310:(e,l,t)=>{t.r(l),t.d(l,{default:()=>oe});var a=t(3673);const n={class:"row justify-between"},o={class:"row justify-between"},i=(0,a._)("div",{class:"q-mt-lg text-grey"},[(0,a._)("p",null,[(0,a._)("b",null,"蒙哥账单"),(0,a.Uk)(" 是一款多人账单计算器。如多人在一次活动中都有付款，每次付款又可能涉及不同的参与者，可快速计算每个人的支付金额。 ")]),(0,a._)("p",null,"由 Kevin Ma 设计开发。")],-1);function r(e,l,t,r,s,u){const m=(0,a.up)("members"),d=(0,a.up)("q-space"),p=(0,a.up)("q-btn"),c=(0,a.up)("q-stepper-navigation"),w=(0,a.up)("q-step"),f=(0,a.up)("bills"),g=(0,a.up)("check"),b=(0,a.up)("q-stepper"),h=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(h,{padding:""},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{modelValue:e.step,"onUpdate:modelValue":l[0]||(l[0]=l=>e.step=l),animated:"",color:"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{name:1,title:"成员",icon:"group","active-icon":"group","done-icon":"group",done:e.step>1},{default:(0,a.w5)((()=>[(0,a.Wm)(m),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a._)("div",n,[(0,a.Wm)(d),(0,a.Wm)(p,{push:"",color:"primary",label:"账单","icon-right":"navigate_next",onClick:e.next},null,8,["onClick"])])])),_:1})])),_:1},8,["done"]),(0,a.Wm)(w,{name:2,title:"账单",icon:"receipt","active-icon":"receipt","done-icon":"receipt",done:e.step>2},{default:(0,a.w5)((()=>[(0,a.Wm)(f),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a.Wm)(p,{push:"",color:"primary",label:"成员",icon:"navigate_before",onClick:e.back},null,8,["onClick"]),(0,a.Wm)(p,{push:"",color:"primary",label:"结算","icon-right":"navigate_next",onClick:e.next},null,8,["onClick"])])])),_:1})])),_:1},8,["done"]),(0,a.Wm)(w,{name:3,title:"结算",icon:"receipt_long","active-icon":"receipt_long","done-icon":"receipt_long",done:e.step>3},{default:(0,a.w5)((()=>[(0,a.Wm)(g),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{push:"",color:"primary",label:"账单",icon:"navigate_before",onClick:e.back},null,8,["onClick"])])),_:1})])),_:1},8,["done"])])),_:1},8,["modelValue"]),i])),_:1})}var s=t(1959),u=t(7874),m=t(2323);const d={class:"row q-gutter-sm"},p={class:"col-auto"},c=(0,a.Uk)("添加"),w=(0,a._)("div",{class:"text-h6"},"添加新成员",-1);function f(e,l,t,n,o,i){const r=(0,a.up)("q-chip"),s=(0,a.up)("q-btn"),u=(0,a.up)("q-card-section"),f=(0,a.up)("q-icon"),g=(0,a.up)("q-input"),b=(0,a.up)("q-card-actions"),h=(0,a.up)("q-card"),_=(0,a.up)("q-dialog"),k=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.$store.state.meerkat.members,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e,class:"col-auto"},[(0,a.Wm)(r,{ripple:!1},{default:(0,a.w5)((()=>[(0,a.Uk)((0,m.zw)(e),1)])),_:2},1024)])))),128)),(0,a._)("div",p,[(0,a.Wm)(s,{push:"",rounded:"",color:"primary","text-color":"white",icon:"add",onClick:e.showDialog},{default:(0,a.w5)((()=>[c])),_:1},8,["onClick"])])]),(0,a.Wm)(_,{modelValue:e.dialog,"onUpdate:modelValue":l[1]||(l[1]=l=>e.dialog=l)},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{style:{"min-width":"350px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[w])),_:1}),(0,a.Wm)(u,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{ref:"name",modelValue:e.newMember,"onUpdate:modelValue":l[0]||(l[0]=l=>e.newMember=l),outlined:"",label:"名称",rules:[e=>!!e||"请输入名称",l=>e.$store.state.meerkat.members.indexOf(l)<0||"名称已存在"],"lazy-rules":[]},{prepend:(0,a.w5)((()=>[(0,a.Wm)(f,{name:"person"})])),_:1},8,["modelValue","rules"])])),_:1}),(0,a.Wm)(b,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(s,{flat:"",label:"取消"},null,512),[[k]]),(0,a.Wm)(s,{push:"",color:"primary",label:"添加",onClick:e.addMember},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}const g=(0,a.aZ)({name:"Members",data(){return{newMember:"",dialog:!1}},watch:{dialog(e){e||(this.newMember="")}},methods:{showDialog(){this.dialog=!0},addMember(){this.$refs.name.validate()&&(this.$store.commit("meerkat/addMember",this.newMember),this.dialog=!1)}}});var b=t(7030),h=t(8240),_=t(5926),k=t(151),W=t(5589),q=t(4842),v=t(4554),Z=t(9367),y=t(677),C=t(7518),Q=t.n(C);g.render=f;const V=g;Q()(g,"components",{QChip:b.Z,QBtn:h.Z,QDialog:_.Z,QCard:k.Z,QCardSection:W.Z,QInput:q.Z,QIcon:v.Z,QCardActions:Z.Z}),Q()(g,"directives",{ClosePopup:y.Z}),(0,a.dD)("data-v-6fdb500e");const x=(0,a._)("b",null,"付款人",-1),B={class:"q-ml-sm"},D=(0,a._)("b",null,"参与者",-1),$={key:0},M=(0,a._)("div",{class:"text-h6"},"添加账单",-1);function U(e,l,t,n,o,i){const r=(0,a.up)("q-item-label"),s=(0,a.up)("q-item-section"),u=(0,a.up)("q-btn"),d=(0,a.up)("q-item"),p=(0,a.up)("q-list"),c=(0,a.up)("q-separator"),w=(0,a.up)("q-card-section"),f=(0,a.up)("q-icon"),g=(0,a.up)("q-select"),b=(0,a.up)("q-input"),h=(0,a.up)("q-card-actions"),_=(0,a.up)("q-card"),k=(0,a.up)("q-dialog"),W=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(p,{separator:""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.$store.state.meerkat.bills,((l,t)=>((0,a.wg)(),(0,a.j4)(d,{key:t,class:"q-py-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[x,(0,a._)("span",B,(0,m.zw)(l.payer),1)])),_:2},1024),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[D,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.participants,((e,t)=>((0,a.wg)(),(0,a.iD)("span",{key:e,class:"q-ml-sm"},[(0,a._)("span",null,(0,m.zw)(e),1),t+1<l.participants.length?((0,a.wg)(),(0,a.iD)("span",$,",")):(0,a.kq)("",!0)])))),128))])),_:2},1024)])),_:2},1024),(0,a.Wm)(s,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,m.zw)(l.memo),1)])),_:2},1024),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Uk)("¥"+(0,m.zw)(l.amount),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(s,{side:""},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{flat:"",dense:"",color:"dark",icon:"delete",onClick:l=>e.$store.commit("meerkat/deleteBill",t)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,a.Wm)(c),(0,a.Wm)(u,{push:"",rounded:"",color:"primary",class:"q-mt-lg full-width",label:"添加消费",icon:"add",onClick:e.showDialog},null,8,["onClick"]),(0,a.Wm)(k,{modelValue:e.dialog,"onUpdate:modelValue":l[4]||(l[4]=l=>e.dialog=l)},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{style:{"min-width":"360px","max-width":"520px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[M])),_:1}),(0,a.Wm)(w,{class:"q-pt-none q-gutter-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{ref:"payer",modelValue:e.newBill.payer,"onUpdate:modelValue":l[0]||(l[0]=l=>e.newBill.payer=l),outlined:"",options:e.$store.state.meerkat.members,label:"付款人",rules:[e=>!!e||"请选择付款人"]},{prepend:(0,a.w5)((()=>[(0,a.Wm)(f,{name:"person"})])),_:1},8,["modelValue","options","rules"]),(0,a.Wm)(g,{ref:"participants",modelValue:e.newBill.participants,"onUpdate:modelValue":l[1]||(l[1]=l=>e.newBill.participants=l),outlined:"",multiple:"","use-chips":"",options:e.$store.state.meerkat.members,label:"参与者",hint:"付款人如需均摊也应包含在内",rules:[e=>e.length>0||"请选择至少一位参与者"]},{prepend:(0,a.w5)((()=>[(0,a.Wm)(f,{name:"people"})])),"before-options":(0,a.w5)((()=>[(0,a.Wm)(u,{class:"full-width q-py-md",align:"left",flat:"",label:"选择全部",onClick:e.selectAllMemberAsParticipants},null,8,["onClick"])])),_:1},8,["modelValue","options","rules"]),(0,a.Wm)(b,{ref:"amount",modelValue:e.newBill.amount,"onUpdate:modelValue":l[2]||(l[2]=l=>e.newBill.amount=l),modelModifiers:{number:!0},outlined:"",label:"金额",type:"number",rules:[e=>!!e||"请输入金额"]},{prepend:(0,a.w5)((()=>[(0,a.Wm)(f,{name:"paid"})])),_:1},8,["modelValue","rules"]),(0,a.Wm)(b,{modelValue:e.newBill.memo,"onUpdate:modelValue":l[3]||(l[3]=l=>e.newBill.memo=l),outlined:"",label:"备忘（可选）",type:"text"},{prepend:(0,a.w5)((()=>[(0,a.Wm)(f,{name:"comment"})])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(h,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{flat:"",label:"取消"},null,512),[[W]]),(0,a.Wm)(u,{push:"",color:"primary",label:"添加",onClick:e.addBill},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}(0,a.Cn)();const I=(0,a.aZ)({name:"Bills",data(){return{dialog:!1,newBill:{payer:null,participants:[],amount:null,memo:null}}},watch:{dialog(e){e||(this.newBill={payer:null,participants:[],amount:null,memo:null})}},methods:{showDialog(){this.dialog=!0},selectAllMemberAsParticipants(){this.newBill.participants=this.$store.state.meerkat.members},addBill(){this.$refs.payer.validate()&&this.$refs.participants.validate()&&this.$refs.amount.validate()&&(this.$store.commit("meerkat/addBill",this.newBill),this.dialog=!1)}}});var z=t(7011),S=t(3414),H=t(2035),Y=t(2350),P=t(5869),A=t(9056);I.render=U,I.__scopeId="data-v-6fdb500e";const j=I;Q()(I,"components",{QList:z.Z,QItem:S.Z,QItemSection:H.Z,QItemLabel:Y.Z,QBtn:h.Z,QSeparator:P.Z,QDialog:_.Z,QCard:k.Z,QCardSection:W.Z,QSelect:A.Z,QIcon:v.Z,QInput:q.Z,QCardActions:Z.Z}),Q()(I,"directives",{ClosePopup:y.Z});const K=(0,a._)("span",{class:"q-mx-sm"},"人共计消费",-1),L=(0,a._)("span",{class:"q-mx-sm"},"需向",-1),O=(0,a._)("span",{class:"q-mx-sm"},"支付",-1);function N(e,l,t,n,o,i){const r=(0,a.up)("q-banner"),s=(0,a.up)("q-item-label"),u=(0,a.up)("q-item-section"),d=(0,a.up)("q-item"),p=(0,a.up)("q-list");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(r,{class:"q-mb-lg bg-grey-3",rounded:""},{default:(0,a.w5)((()=>[(0,a._)("b",null,(0,m.zw)(e.$store.getters["meerkat/totalMembers"]),1),K,(0,a._)("b",null,"¥"+(0,m.zw)(e.$store.getters["meerkat/totalBills"]),1)])),_:1}),(0,a.Wm)(p,{separator:"",bordered:"",class:"rounded-borders"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.data,((e,l)=>((0,a.wg)(),(0,a.j4)(d,{key:l},{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[(0,a._)("b",null,(0,m.zw)(e.from),1),L,(0,a._)("b",null,(0,m.zw)(e.to),1),O,(0,a._)("b",null,"¥"+(0,m.zw)(e.amount),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})],64)}var T=t(4228);function E(e){return Math.trunc(100*e)}function F(e,l){const t=[];for(var a=0;a<e.length;a++){const l=[];for(var n=0;n<e.length;n++)l.push((0,T.Z)({amount:0}));t.push(l)}for(var o=0;o<l.length;o++){const a=l[o],n=a.payer,i=a.participants,r=(0,T.Z)({amount:E(a.amount)}),s=r.divide(i.length),u=e.indexOf(n);i.forEach((l=>{const a=e.indexOf(l);a!=u&&(t[a][u]=t[a][u].add(s))}))}for(var i=1;i<t.length;i++)for(var r=0;r<i;r++)if(i!=r){var s=i,u=r;t[i][r].lessThan(t[r][i])&&(s=r,u=i),t[s][u]=t[s][u].subtract(t[u][s]),t[u][s]=(0,T.Z)({amount:0})}const m=[];for(var d=0;d<t.length;d++)for(var p=0;p<t.length;p++)t[d][p].greaterThan((0,T.Z)({amount:0}))&&m.push({from:e[d],to:e[p],amount:t[d][p].toFormat("0,0.00")});return m}T.Z.defaultCurrency="CNY",T.Z.defaultPrecision=2;const R=(0,a.aZ)({name:"Check",data(){return{data:[]}},mounted(){this.data=F(this.$store.state.meerkat.members,this.$store.state.meerkat.bills)}});var G=t(5607);R.render=N;const J=R;Q()(R,"components",{QBanner:G.Z,QList:z.Z,QItem:S.Z,QItemSection:H.Z,QItemLabel:Y.Z});const X=(0,a.aZ)({name:"PageIndex",components:{Members:V,Bills:j,Check:J},setup(){const e=(0,u.oR)(),l=(0,s.iH)(e.getters["meerkat/step"]);return{step:l,next(){l.value++},back(){l.value--}}}});var ee=t(4379),le=t(3518),te=t(4340),ae=t(118),ne=t(2025);X.render=r;const oe=X;Q()(X,"components",{QPage:ee.Z,QStepper:le.Z,QStep:te.Z,QStepperNavigation:ae.Z,QSpace:ne.Z,QBtn:h.Z})}}]);